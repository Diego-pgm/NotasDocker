Docker

Comandos:
# Para ver mi version de ubuntu 
>>lsb_release -a 

# Correr un hello world de docker
>> docker run hello-world

# Para ver mis imagenes (usar grep para filtrar)
>> docker images

# Para descargar una imagen
>> docker pull mongo/mysql:8.0.0/etc

# para ver los procesos
>> docker ps -a 

# Para ver los contenedores
>> docker ps 

# Agregar un usuario de docker
>> sudo usermod -aG docker diego

# Crear una imagen
>> docker build -d nom_imagen:tag
>> docker build -t apache .

# Ver las capas de una imagen
>> docker history -H nom_imagen:tag

# Crear un contenedor
>> docker run -d --name nom_contenedor -p puerto-maq:puerto-cont nom_imagen:tag 

# Eliminar un contenedor.
>> docker rm -fv nom_contenedor



[+] DockerFile [+]

Es un archivo que contiene las capas de una imagen y sus campos son:

FROM os/img : Desde la imagen o sistema op que va a ser nuestra imagen personalizada.
RUN comando : Corre los comandos.
COPY/ADD carpeta /var/www/html : Sirve para copiar archivos de nuestra maquina a la imagen.
ENV nom-var valor : Crea una variable y le asigna un valor.
WORKDIR directorio : Nos situa en un directorio para trabajar (a veces se usa /var/www/html cuando es apache).
EXPOSE num-puerto : Nos permite establecer un puerto para posteriormente utilizarlo.
LABEL label=valor : Agregan metadata a una imagen.
USER nombre: El usuario que esta ejecutando las tareas.
VOLUME : Es una manera de colocar la data persistente en el contenedor.
CMD apachectl -DFOREGROUND : Es lo que mantiene vivo al contenedor.


Crear un script para probar el CMD que se llame run.sh:
#!/bin/bash

echo "Iniciando container..."
echo "INICIADO!!" > /var/www/html/ini.html
apachectl -DFOREGROUND

Con dockerignore le decimos la imagen que archivos ignorar.

# Para ver el peso de los archivos en una carpeta
>>du -shc * 

# Para construir sin los archivos que se especifican en el .dockerignore
>> docker build -t apache .|less

Ejemplo de un Dockerfile:
FROM ubuntu:21.04

RUN apt-get update
ARG DEBIAN_FRONTEND=noninteractive
RUN apt-get -qq -y install apache2

CMD apachectl -DFOREGROUND

